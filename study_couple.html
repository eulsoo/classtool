<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>스터디 커플 메이커</title>
<link href="https://fonts.googleapis.com/css?family=Noto+Serif+KR:300,400,700" rel="stylesheet">
<style>
body {padding:40px; font-family: 'Noto Serif KR', serif;}
* {margin:0; padding:0}
li {list-style-type:none;}
.class_member {position: relative; padding:20px; border-bottom:8px solid black}
.class_member + .class_member {margin-top:30px}
.class_member .members > li {float:left; font-size:20px; }
.class_member h3 {font-weight: 700; margin-bottom:10px; font-size: 16px; letter-spacing: 2px; color:#999}
.class_member .members > li + li {margin-left:20px; position: relative;}
.class_member .members > li + li:after {content:''; position: absolute; width:4px; height:4px; background-color:lime; border-radius:2px; left:-12px; top:15px;}
.class_member .members:after {clear:both; content:''; display:block;}
.class_member .go {padding:10px; font-size:20px; position: absolute; right:40px; top:30px; bottom:0; margin:auto 0; text-decoration-color:lime; color:rgb(187, 73, 20); height:30px}
</style>
</head>
<body>
<div  class="class_member">
    <h3>의민반</h3>
	<ul class="members">
		<!-- <li>일수민</li>
		<li>이수길</li>
		<li>삼수고</li>
		<li>사수로</li>
		<li>오수길</li>
		<li>육수송</li>
		<li>칠수나</li> -->
	</ul>
    <a href="" class="go">짝 만들기.</a>
    <ul class="couple">

    </ul>
</div>
<script>

// 데이터 준비
var 요청URL = "https://raw.githubusercontent.com/eulsoo/classtool/master/student.json";

var 요청객체 = new XMLHttpRequest();
요청객체.open("GET", 요청URL);
요청객체.responseType = "json";
요청객체.send();
요청객체.onload = function () {
    var students = 요청객체.response;
    classtool(students);
}

function classtool(students) {
    var targetMembers = students.의민반.member;
    var coupled = students.의민반.coupled;
    var ulElem = document.querySelector(".members");
    var nowCouple = [];

    for (let i = 0; i < targetMembers.length; i++) {
        var liElem = document.createElement("li");
        var liName = document.createTextNode(targetMembers[i]);
        liElem.appendChild(liName);
        ulElem.appendChild(liElem);
    }
    
    document.querySelector(".class_member > .go").addEventListener("click", makeCouple);
    function makeCouple(e) {
        e.preventDefault();

        roof();

        function roof() {
            if (targetMembers.length === 0) {
                return;
            }
            var meeting = [];
            meeting.push(targetMembers[0]); // 미팅장소로 보낸다
            targetMembers.splice(0, 1); // 원래그룹에서는 뺀다

            for (let i = 0; i < targetMembers.length; i++) {
                if (wasCouple(meeting[0], targetMembers[i])) {
                    continue;
                } else {
                    meeting.push(targetMembers[i]);
                    coupled[meeting[0]].push(targetMembers[i]);
                    coupled[targetMembers[i]].push(meeting[0]);
                    targetMembers.splice(i, 1);
                    break;
                }
            }
            nowCouple.push(meeting); // 미팅된 커플을 최종 짝으로 보낸다.
            roof(); // 다시 시작한다.
        }

        function wasCouple(leftMan, rightMan) {
            // if (coupled[leftMan].length === 0 && coupled[rightMan].length ===0 ) {
            //     console.log("짝없었음");
            //     return false;
            // }
            for (let i = 0; i < coupled[leftMan].length; i++) {
                if (coupled[leftMan][i] === rightMan) {
                    return true;
                } else {
                    return false;
                }
            }
        }

        for (let i = 0; i < nowCouple.length; i++) {
            console.log(nowCouple[i][0] + ":" + nowCouple[i][1]);
        }
        console.log(nowCouple);
        console.log(coupled);
        console.log(targetMembers);
        nowCouple = [];
    }


}



</script>
</body>
</html>



